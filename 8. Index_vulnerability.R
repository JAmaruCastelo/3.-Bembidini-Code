# Vulnerability index -----------------------------------------------------
library(raster)
library(terra)
# Load Files --------------------------------------------------------------
#Ocurrences
path_occ=list.files("D:/00017-Bebidini_Articulo/0. Ocurrencias/4.- Ocurrencias con modelos maxent", full.names=T)
#Binaries
path_bp=list.files("D:/00017-Bebidini_Articulo/2. Rich_Bembidini_areas and Refugia/Binaries/Presente", full.names=T)
path_bf=list.files("D:/00017-Bebidini_Articulo/2. Rich_Bembidini_areas and Refugia/Binaries/Futuro", full.names=T)
#logistics
path_lbm="D:/00017-Bebidini_Articulo/1. Maxent"


# make it iteratively in each path_occ ------------------------------------
name<-c()
VA_a<-c()
VO_a<-c()
VS_a<-c()
for (e in 1:length(path_occ)){
  path_point=path_occ[e]
  bp=path_bp[e]
  bf=path_bf[e]
  name=strsplit(path_point, "/")[[1]][5]
  lbp=list.files(paste(path_lbm,"/",name, sep=""), pattern="promedio_futuro", full.name=T)
  lbf=list.files(paste(path_lbm,"/",name, sep=""), pattern="logistico_presente_world", full.name=T)
  VA<-va(bp, bf)
  VO<-vo(bp, bf)
  SC<-sc(lbp, lbf, path_point)
  VS<-vs(SC)
  VA_a<-append(VA_a, VA)
  VO_a<-append(VO_a, VO)
  VS_a<-append(VS_a, VS)
  name<-append(name, strsplit(path_point, "/")[[1]][5])
}
dataframe<- cbind(path_occ, VA_a, VO_a, VS_a)


# Save the vulnerability index calculated ---------------------------------
setwd("D:/00017-Bebidini_Articulo/2. Maxent Calculations/Vulnerability index") # change according to the folder to save the information
write.csv(dataframe, "vulnerabilty.csv")


